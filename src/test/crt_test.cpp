#include <iostream>

#include "HEAAN/advanced/crt.h"

int main(){
    const int L = 5;
    uint64_t q[L]={1152921504606847009ULL,1152921504606847067ULL,1152921504606847081ULL,
        1152921504606847123ULL,1152921504606847127ULL};
    uint64_t Q[L] ={1152921511605894031ULL,7061644215745039378ULL,18293621686378994491ULL,
    148337312726515737ULL,17592186044416ULL};
    uint64_t inv_mod_Q_over_q[L]={374780938740401504ULL,387046725920719412ULL,155253934270469693ULL,87815624098227291ULL,
    148024281577029162ULL};

    uint64_t Q_over_q[L][L]={{2305843009425786287ULL,3458764513820990803ULL,2224778215921025376ULL,281474976710656ULL,
    0ULL},{13835058055359076317ULL,16285016252571969520ULL,1963569437533536516ULL,281474976710656ULL
    ,0ULL},{11529215046135127351ULL,14411518807585815157ULL,1900519042750349554ULL,281474976710656ULL
    ,0ULL},{4611686018475000469ULL,12249790986447920044ULL,1711367858400788677ULL,281474976710656ULL,
    0ULL},{9223372036901127113ULL,1585267068834581510ULL,1693353459891306690ULL,281474976710656ULL,
    0ULL}};


    CRT<L> crt(q,Q,inv_mod_Q_over_q,Q_over_q);

    uint64_t a[L] = {2496847982066394524ULL,6179808641469508490ULL,4613858499374131512ULL,
14039320798214412288ULL,10083004203411ULL};

    uint64_t a_rns[L] = {753612675309782689ULL,8006693014835917ULL,16048976969132353ULL,376433015983029137ULL,
148789351586435012ULL};

    uint64_t a_rns_measured[L] = {0};
    crt.icrt(a, a_rns_measured);
    for(int i = 0; i < L; ++i)
        std::cout << a_rns[i] - a_rns_measured[i] << " ";
    std::cout << std::endl;

    uint64_t a_measured[L] = {0};
    crt.crt(a_rns, a_measured);
    for(int i = 0; i < L; ++i)
        std::cout << a[i] - a_measured[i] << " ";
    std::cout << std::endl;
}